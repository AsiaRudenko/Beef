<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) Avanade. Licensed under the MIT License. See https://github.com/Avanade/Beef -->
<Template OutputGenDirName="Generated">
  <Table Condition="Table.Udt == true and Table.Tvp != null" OutputFileName="{{Table.Tvp}}DataTvp.cs" OutputDirName="Data">
    <Set Name="System.IsDeleted" Value="false" />
    <Set Name="System.OrgUnitId" Value="false" />
    <Set Name="System.MultiTenancy" Value="false"/>
    <Column>
      <Set Name="System.IsDeleted" Condition="Column.Name == 'IsDeleted'" Value="true" />
      <Set Name="System.OrgUnitId" Condition="Column.Name == 'OrgUnitId' and Column.IsPrimaryKey == false" Value="true" />
      <Set Name="System.MultiTenancy" Condition="Column.Name == 'TenantId' and Column.IsPrimaryKey == false" Value="true" />
    </Column>

    <![CDATA[/*
 * This file is automatically generated; any changes will be lost. 
 */

#nullable enable

using System;
using System.Collections.Generic;
using System.Data;
using Beef.Data.Database;
]]>
        <![CDATA[using {{Config.Company}}.{{Config.AppName}}.Common.Entities;

namespace {{Config.Company}}.{{Config.AppName}}.Business.Data
{
    public partial class {{Table.Tvp}}Data
    {
        public partial class DbMapper
        {
            /// <summary>
            /// Creates a <see cref="TableValuedParameter"/> for the <paramref name="list"/>.
            /// </summary>
            /// <param name="list">The entity list.</param>
            /// <returns>The Table-Valued Parameter.</returns>
            public TableValuedParameter CreateTableValuedParameter(IEnumerable<{{Table.Tvp}}> list)
            {        
                var dt = new DataTable();
]]>
    <Column Condition="Column.UdtExclude == false and Column.Name != 'TenantId' and Column.Name != 'CreatedDate' and Column.Name != 'CreatedBy' and Column.Name != 'UpdatedDate' and Column.Name != 'UpdatedBy' and Column.Name != 'IsDeleted' and Column.IsComputed == false">
      <![CDATA[                dt.Columns.Add("{{Column.Name}}", typeof({{Column.DotNetType}}));
]]>
    </Column>
    <![CDATA[
                var tvp = new TableValuedParameter("[{{Table.Schema}}].[udt{{Table.Name}}List]", dt);
                AddToTableValuedParameter(tvp, list);
                return tvp;
            }
        }
    }
}

#nullable restore]]>
  </Table>
</Template>